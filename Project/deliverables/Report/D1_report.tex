% IMPORTANT: add or remove (comment out) the boolean '\solutiontrue' below to
% create the solution document or the exercise document respectively.
% First we create the switch to make either the exercises or the solutions
\newif\ifsolution\solutionfalse
% To create the solution uncomment '\solutiontrue'
\solutiontrue

\documentclass[a4paper,11pt]{scrartcl}

\title{Formal Methods for Information Security}

\author{Mathias Woringer \\ \href{mailto:mworinger@student.ethz.ch} {mworinger@student.ethz.ch}
\and Gian-Luca Piras \\ \href{mailto:gpiras@student.ethz.ch}{gpiras@student.ethz.ch}}

\ifsolution
\subtitle{\textbf{Project report}}
\fi

\usepackage[T1]{fontenc}
\usepackage{ae, aecompl}
\usepackage{a4wide}
\usepackage{boxedminipage}
\usepackage{graphicx}
\usepackage{subfigure}
\usepackage{enumerate}
\usepackage{url}
\usepackage{listings}
\usepackage{comment}
\usepackage{bibentry}
\usepackage{hyperref}
\usepackage{underscore}
\usepackage{listings}
\usepackage{parcolumns}
\usepackage[toc,page]{appendix}
\usepackage{enumitem}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{enumerate}
\usepackage{xcolor}

\ifsolution\includecomment{final}
\else\excludecomment{final}\fi

% ------------ Listings Settings
\lstset{%
  basicstyle=\small\ttfamily,
  frame=none,
  framexleftmargin=0pt,
  captionpos=b,
  showspaces=false,
  showstringspaces=false,
  showtabs=false,         
  tabsize=4,
  breaklines=true,
  breakatwhitespace=false}

% Some useful commands and environments
\usepackage{framed}
\newenvironment{solution}%
{\par{\noindent\small\textit{Solution:}}\vspace{-12pt}\begin{framed}}%
{\end{framed}\par}

\begin{document}
\maketitle

\section{PACE protocol}
\subsection{A simple challenge-response protocol}
The following simple challenge-response protocol was formalized in Tamarin:
\begin{align*}
  A \rightarrow B: x\\
  B \rightarrow A: [x]_{k(a,b)}
\end{align*}
The MAC function was realised by an user-defined function with two parameters in Tamarin.  The details can be found in file \textbf{P1.spthy}. 
\subsection{Mutual authentication}
The challenge-response protocol is extended in this subtask in that now it is not just Alice who sends a nonce x to Bob.  Bob now also generates and sends a nonce y,  which is sent to A. The goal of the protocol is to reach an agreement between the two roles A and B with both nonces. Formally, the protocol now looks like this:
\begin{align*}
A \rightarrow B: x\\
B \rightarrow: y\\
A \rightarrow B: [y]_{k(b,a)}\\
B \rightarrow A: [x]_{k(a,b}
\end{align*}
Further details can be taken from the file \textbf{P2a.spthy}.
\begin{enumerate}[label=\alph*)]
	\item If we assume that there can be a network attacker who can eavesdrop on all the information exchanged.  So we can assume that this protocol is vulnerable to \textit{
	replay attacks}. Since neither Alice nor Bob include any information in their messages to authenticate the message, it can be intercepted by an eavesdropper and resent later.
	An attack scenario could look like following:
	\begin{align*}
	A \rightarrow A'_{eaves}: x\\
	A'_{eaves} \rightarrow B: x'\\
	B \rightarrow A : y\\
	A \rightarrow B : [y]_{k(a,b)}
	\end{align*}
	\item Fix the property
\end{enumerate}
\subsection{Introducing a session key}
\begin{enumerate}[label=\alph*)]
	\item Solution a
	\item Solution b
\end{enumerate}
\subsection{Replace the password by a nonce}
\subsection{Introducing Diffie-Hellman: The PACE protocol}
\begin{enumerate}[label=\alph*)]
	\item Solution a
	\item Solution b
	\item Solution c
	\item Solution d
\end{enumerate}
\section{The Off-the-Record Messaging Protocol}
\subsection{Modeling the original OTR Key Exchange}
\subsection{Authentication Failure}
\subsection{Improvement}
\subsection{SIGMA}
\end{document}
