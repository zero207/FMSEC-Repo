% IMPORTANT: add or remove (comment out) the boolean '\solutiontrue' below to
% create the solution document or the exercise document respectively.
% First we create the switch to make either the exercises or the solutions
\newif\ifsolution\solutionfalse
% To create the solution uncomment '\solutiontrue'
\solutiontrue

\documentclass[a4paper,11pt]{scrartcl}

\title{Formal Methods for Information Security}

\author{Mathias Woringer \\ \href{mailto:mworinger@student.ethz.ch} {mworinger@student.ethz.ch}
\and Gian-Luca Piras \\ \href{mailto:gpiras@student.ethz.ch}{gpiras@student.ethz.ch}}

\ifsolution
\subtitle{\textbf{Project report}}
\fi

\usepackage[T1]{fontenc}
\usepackage{ae, aecompl}
\usepackage{a4wide}
\usepackage{boxedminipage}
\usepackage{graphicx}
\usepackage{subfigure}
\usepackage{enumerate}
\usepackage{url}
\usepackage{listings}
\usepackage{comment}
\usepackage{bibentry}
\usepackage{hyperref}
\usepackage{underscore}
\usepackage{listings}
\usepackage{parcolumns}
\usepackage[toc,page]{appendix}
\usepackage{enumitem}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{enumerate}
\usepackage{xcolor}

\ifsolution\includecomment{final}
\else\excludecomment{final}\fi

% ------------ Listings Settings
\lstset{%
  basicstyle=\small\ttfamily,
  frame=none,
  framexleftmargin=0pt,
  captionpos=b,
  showspaces=false,
  showstringspaces=false,
  showtabs=false,         
  tabsize=4,
  breaklines=true,
  breakatwhitespace=false}

% Some useful commands and environments
\usepackage{framed}
\newenvironment{solution}%
{\par{\noindent\small\textit{Solution:}}\vspace{-12pt}\begin{framed}}%
{\end{framed}\par}

\begin{document}
\maketitle

\section{The PACE protocol}
The  referenced files are the theory files, each of which contains an executability lemma for the described protocols as well as additional lemmas that map the security properties required in the task.
\subsection{A simple challenge-response protocol}
The following simple challenge-response protocol was formalized in Tamarin:
\begin{align*}
  A \rightarrow B: x\\
  B \rightarrow A: [x]_{k(a,b)}
\end{align*}
The MAC function was realised by an user-defined function with two parameters in Tamarin.  The details can be found in theory file \textbf{PACE_1.spthy}. 
\subsection{Mutual authentication}
The challenge-response protocol is extended in this subtask in that now it is not just Alice who sends a nonce x to Bob.  Bob now also generates and sends a nonce y,  which is sent to A. The goal of the protocol is to reach an agreement between the two roles A and B with both nonces. Formally, the protocol now looks like this:
\begin{align*}
A \rightarrow B: x\\
B \rightarrow A: y\\
A \rightarrow B: [y]_{k(b,a)}\\
B \rightarrow A: [x]_{k(a,b}
\end{align*}
For the first revision of the protocol, we implemented two different protocol approaches. Firstly, we designed the protocol sequentially. This means that Alice must have received something from Bob before Alice can send something to Bob. This variant can be found in the file \textbf{PACE_2a_seq.spthy}. Furthermore, we have implemented a parallel variant, which can be found under \textbf{PACE_2a.spthy}. To be able to carry out the MIM attack, the sequential variant is needed.
\begin{enumerate}[label=\alph*)]
	\item If we assume that there can be a network attacker who can eavesdrop on all the information exchanged.  So we can assume that this protocol is vulnerable to \textit{
	MIM attacks}. Since neither Alice nor Bob include any information in their messages to authenticate the message, it can be intercepted by an eavesdropper. Alice thinks she is    	talking to Bob. However, she is talking to Bob. Bob, on the other hand, thinks he is talking to Alice although he is talking to the attacker who is pretending to be Alice.
	An attack scenario could look like following:
	\begin{align*}
	A \rightarrow A'_{eaves}: x\\
	A'_{eaves} \rightarrow B: x'\\
	B \rightarrow A : y\\
	A \rightarrow B : [y]_{k(a,b)}
	\end{align*}
	\item The problem with the protocol in a) is the fact that neither Alice nor Bob authenticate their messages. Thus, neither Alice nor Bob can actually know whether the	    				message they receive comes from the person they want. In order to eliminate this weakness, an identifier of the respective identity is given to the message. Thus, the property 		of the injective agreement now holds for both.
	\begin{align*}
	A \rightarrow B: x\\
	B \rightarrow A: y\\
	A \rightarrow B: [<A, x, y>]_{k(b,a)}\\
	B \rightarrow A: [<B, x, y>]_{k(a,b)}
	\end{align*}
	As before we have created a a sequential protocol ( see theory file \textbf{PACE_2b_seq.spthy}) and a parallel protocol ( see theory file \textbf{PACE_2b.spthy}).
\end{enumerate}
\subsection{Introducing a session key}
\begin{enumerate}[label=\alph*)]
	\item Solution a
	\item Solution b
\end{enumerate}
\subsection{Replace the password by a nonce}
\subsection{Introducing Diffie-Hellman: The PACE protocol}
\begin{enumerate}[label=\alph*)]
	\item Solution a
	\item Solution b
	\item Solution c
	\item Solution d
\end{enumerate}
\section{The Off-the-Record Messaging Protocol}
\subsection{Modeling the original OTR Key Exchange}
\subsection{Authentication Failure}
\subsection{Improvement}
\subsection{SIGMA}
\end{document}
